<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!-- $Id: CM-CSM-WF.xml 4463 2016-07-06 15:44:27Z gmusial $
	 Maestro version: 1.19.6 -->
	
<workflow xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="workflowDefinition.xsd">
	<name>CM-CSM-WF</name> 
  	<externalWorkflowCode>CM-CSM-WF</externalWorkflowCode> 
  	<finishOrchestrationASAPOnError>false</finishOrchestrationASAPOnError> 
	<description>CM-CSM-WF ($LastChangedRevision: 4463 $)</description>
	
	<properties>
		<inputProperties>
			<property name="WF-EOD-EOM-INDICATOR"/>
			<property name="SOURCE-SYSTEM" />
			<property name="RUN-ID" /> <!-- INITIALIZE-RUN.P_RUN_ID_O -->
			<property name="BUSINESS-DATE" />
			<!-- CSM -->
			<property name="BUSINESS-DATE-FORMATTED"/><!-- INITIALIZE-RUN.BUSINESS-DATE-FORMATTED -->
			<property name="IS-MONTH-END"/>
			<!-- CSM -->
		</inputProperties>
		<generalProperties>
			<property name="ROOT-WF-ID">CM-CSM-WF</property>
			<property name="RUN-ENV">${MAESTRO_RUN_ENV}</property>
			
			<!-- Source Directories -->
			<property name="FTP-SOURCE-DIR">csm/inbox</property>
			<property name="HOLDING-DIR">${CTR_DATA_ROOT_PATH}/manual/csm</property>
			<property name="HOLDING-MATCH-PATTERN">.+_${WF-EOD-EOM-INDICATOR}_${BUSINESS-DATE-FORMATTED}_.+</property>
			<property name="SQLLDR-PROCESSING-SOURCE-DIR">data_in/infiles</property>
			<property name="SQLLDR-CONTROL-DIRECTORY">sqlldr</property>
			<property name="SQLLDR-DISCARD-DIR">data_in/discard</property>
			<property name="SQLLDR-REJECT-DIRECTORY">data_in/reject</property>
			<property name="SQLLDR-LOG-DIRECTORY">data_in/ldrlog</property>
			
			<property name="REPLICATE-SRC-IF-MONTH-END">F</property>
			<property name="DATA-CATEGORY-TYPE">CM</property>
			
			<!-- Source file naming pattern -->
			<property name="SRC-FILE-PRODUCTTYPE-PATTERN">[^_]*[_]?</property>
			<property name="SRC-FILE-FILETYPE-PATTERN">[PT]?[_]?</property>
			<property name="SRC-FILE-FREQUENCY-PATTERN">${WF-EOD-EOM-INDICATOR}_</property>
			
			
			<!-- <property name="SRC-FILE-VERSION-PATTERN-REMOTE">(${INITIALIZE-RUN.BUSINESS-DATE-FORMATTED})?_(${INITIALIZE-RUN.P_RUN_ID_O})?</property>
			<property name="SRC-FILE-VERSION-PATTERN-MANUAL">(${INITIALIZE-RUN.BUSINESS-DATE-FORMATTED})?_[0-9]+</property>
			<property name="SRC-FILE-SUFFIX-PATTERN-MANUAL">${SRC-FILE-PRODUCTTYPE-PATTERN}${SRC-FILE-FILETYPE-PATTERN}${SRC-FILE-FREQUENCY-PATTERN}${SRC-FILE-VERSION-PATTERN-MANUAL}</property>
			<property name="SRC-FILE-SUFFIX-PATTERN-REMOTE">${SRC-FILE-PRODUCTTYPE-PATTERN}${SRC-FILE-FILETYPE-PATTERN}${SRC-FILE-FREQUENCY-PATTERN}${SRC-FILE-VERSION-PATTERN-REMOTE}</property> -->
			
			<property name="SRC-FILE-VERSION-PATTERN-REMOTE">(${BUSINESS-DATE-FORMATTED})?_(${RUN-ID}${SOURCE-SYSTEM}${GET-TIMESTAMP-FOR-PATTERN.fileTimestamp})</property>
			<property name="SRC-FILE-VERSION-PATTERN-MANUAL">(${BUSINESS-DATE-FORMATTED})?_[0-9]+</property>
			<property name="SRC-FILE-SUFFIX-PATTERN-MANUAL">${SRC-FILE-PRODUCTTYPE-PATTERN}${SRC-FILE-FILETYPE-PATTERN}${SRC-FILE-FREQUENCY-PATTERN}${SRC-FILE-VERSION-PATTERN-MANUAL}</property>
			<property name="SRC-FILE-SUFFIX-PATTERN-REMOTE">${SRC-FILE-PRODUCTTYPE-PATTERN}${SRC-FILE-FILETYPE-PATTERN}${SRC-FILE-FREQUENCY-PATTERN}${SRC-FILE-VERSION-PATTERN-REMOTE}</property>
			
		</generalProperties>
	</properties>	

	<sequential name="CTR-CAPITAL-MARKETS" id="CTR-CAPITAL-MARKETS">
		<stage id="GET-TIMESTAMP-FOR-PATTERN" name="GET-TIMESTAMP-FOR-PATTERN">
			<execDefinition>
				<javaExtension>
					<javaExtensionExecutorClassName>com.bns.ctr.maestro.javaexec.CTRUtilExecutor</javaExtensionExecutorClassName>
					<simpleProperties>
						<properties>
							<simpleProperty name="method">getTimestamp</simpleProperty>
							<simpleProperty name="wfInputParam"></simpleProperty>
						</properties>
					</simpleProperties>
					<javaExtensionOutputPropertyNames>
						<propertyName>fileTimestamp</propertyName>
					</javaExtensionOutputPropertyNames>
				</javaExtension>
			</execDefinition>
		</stage>
		
		<externalWorkflowReference name="CM-CSM-ENRICHMENT-REQUEST" id="CM-CSM-ENRICHMENT-REQUEST">
			<externalWorkflowCode>CM-CSM-ENRICHMENT-REQUEST-WF</externalWorkflowCode>
			<inputProperties>
				<property name="RUN-ID">${RUN-ID}</property>
				<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
				<property name="BUSINESS-DATE-FMT">${BUSINESS-DATE-FORMATTED}</property>
				<property name="EOD-EOM-IND">${WF-EOD-EOM-INDICATOR}</property>
				<property name="TIMESTAMP">${GET-TIMESTAMP-FOR-PATTERN.fileTimestamp}</property>
				<property name="SOURCE-SYSTEM">${SOURCE-SYSTEM}</property>
			</inputProperties>
			<outputPropertyMapping>
				<mapping source="RECORD-COUNT" target="RECORD-COUNT"/>			
			</outputPropertyMapping>
		</externalWorkflowReference>
		<stage name="INIT-COMPLETE-CHECK" id="INIT-COMPLETE-CHECK">
			<description>Verify if the common workflow steps completed</description>
			<stageFailure>
				<failureCondition><![CDATA[${RUN-ID} <= 0 || "${CTR_APP_ROOT_PATH}" == '' || "${CTR_ROOT_PATH}" == ''|| "${CTR_FTP_ROOT_PATH}" == ''|| "${CTR_DATA_ROOT_PATH}" == ''|| "${CTR_CONFIG_ROOT_PATH}" == '']]></failureCondition>
				<failureMessage>Common workflow initialization failed</failureMessage>
			</stageFailure>
			<execDefinition>
				<noOpExecDefinition>
					<input>CHECK-IF-INIT-COMPLETE</input>
					<numberOfTasks>1</numberOfTasks>
					<numberOfInterimStatusResponses>1</numberOfInterimStatusResponses>
				</noOpExecDefinition>
			</execDefinition>
		</stage>
		
		<!-- CSM-WORKFLOWS -->
		
		<parallel id="CSM-WORKFLOWS" name="CSM-WORKFLOWS">
			<sequential id="CSM" name="CSM">	
				<stage name="FILEWATCH-CSM-OUTBOX" id="FILEWATCH-CSM-OUTBOX">
					<description>Check CSM SFTP outbox for response files</description>
					<skipCondition>${CM-CSM-ENRICHMENT-REQUEST.RECORD-COUNT} == 0</skipCondition>
					<autoRetryConfiguration>
						<delayBetweenAttemptsInMs>60000</delayBetweenAttemptsInMs>
                        <maximumNumberOfRetryAttempts>240</maximumNumberOfRetryAttempts>
                        <maximumRetryDurationInMs>14400000</maximumRetryDurationInMs>
					</autoRetryConfiguration>
					<execDefinition>
						<pollingFileWatcher>
							<watchedFiles>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Bond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-Bond-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Bond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-Bond-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Equity_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-Equity-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Equity_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-Equity-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_IRFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-IRFuture-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_IRFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-IRFuture-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_EquityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-EquityFuture-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_EquityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-EquityFuture-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_FXFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-FXFuture-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_FXFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-FXFuture-MRK</matchedUriOutputProperty>
								</resource>
								
	              <resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_BondFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-BondFuture-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_BondFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-BondFuture-MRK</matchedUriOutputProperty>
								</resource>
															
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_TBill_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-TBill-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_TBill_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-TBill-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_FRN_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-FRN-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_FRN_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-FRN-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_ConvertibleBond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-CNV-BND-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_ConvertibleBond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-CNV-BND-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_BondFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-BondFutureOption-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_BondFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-BondFutureOption-MRK</matchedUriOutputProperty>
								</resource>
								
	              <resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_CommodityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-CommodityFuture-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_CommodityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-CommodityFuture-MRK</matchedUriOutputProperty>
								</resource>

	              <resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_EquityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-EquityOption-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_EquityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-EquityOption-MRK</matchedUriOutputProperty>
								</resource>
								
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_FXOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-FXOption-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_FXOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-FXOption-MRK</matchedUriOutputProperty>
								</resource>

	              <resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_CommodityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-CommodityOption-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_CommodityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-CommodityOption-MRK</matchedUriOutputProperty>
								</resource>

	              <resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_IRFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-IRFutureOption-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_IRFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-IRFutureOption-MRK</matchedUriOutputProperty>
								</resource>

	              <resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Warrant_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-Warrant-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Warrant_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-Warrant-MRK</matchedUriOutputProperty>
								</resource>

<!-- 	              <resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_TradableLoan_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-TradableLoan-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_TradableLoan_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-TradableLoan-MRK</matchedUriOutputProperty>
								</resource> -->
								
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_PA_(LegalEntity|Entity)_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#PA-LegalEntity-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_PA_(LegalEntity|Entity)_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#PA-LegalEntity-MRK</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Status_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
									<matchedUriOutputProperty>#IN-Status-FILE</matchedUriOutputProperty>
								</resource>
								<resource>
									<uri>${CSM_RESPONSE_URI}</uri>
									<searchPattern>[@NO_MODIF_CHK]CSM_IN_Status_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
									<matchedUriOutputProperty>#IN-Status-MRK</matchedUriOutputProperty>
								</resource>
							</watchedFiles>
							<matchedCountProperty>matchedRemoteCount</matchedCountProperty>
						</pollingFileWatcher>
					</execDefinition>
				</stage>
			
			<stage name="TRANSFER-CSM-FTP-FILES-TO-LOCAL" id="TRANSFER-CSM-FTP-FILES-TO-LOCAL">
				<description>Transfer files from FTP directory to inbound processing directory</description>
				<skipCondition>'${RUN-ENV}' == 'VM' ||  '${CM-CSM-ENRICHMENT-REQUEST.RECORD-COUNT}' == '0' </skipCondition>
				<execDefinition>
					<fileTransfer>
						<transfer>
							<sourceResource>
								<uri>${CSM_RESPONSE_URI}</uri>
								<searchPattern>CSM_.+_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.*(csv|mrk)</searchPattern>
								<matchedUriOutputProperty>matchedFiles</matchedUriOutputProperty>
							</sourceResource>
							<targetResource>
								<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
							</targetResource>
						</transfer>
						<transferCountProperty>matchedCountTransfer</transferCountProperty>
					</fileTransfer>
				</execDefinition>
			</stage>
			
				<parallel id="CHECKSUM-REMOTE" name="CHECKSUM-REMOTE">
					<skipCondition>${CM-CSM-ENRICHMENT-REQUEST.RECORD-COUNT} == 0 </skipCondition>
					<stage name="CHECKSUM-IN-Bond-FILE" id="CHECKSUM-IN-Bond-FILE-REMOTE">
						<description>Validate checksum for file IN-Bond file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Bond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Bond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-Equity-FILE" id="CHECKSUM-IN-Equity-FILE-REMOTE">
						<description>Validate checksum for file IN-Equity file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Equity_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Equity_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					
					<stage name="CHECKSUM-IN-IRFuture-FILE" id="CHECKSUM-IN-IRFuture-FILE-REMOTE">
						<description>Validate checksum for file IN-IRFuture file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_IRFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_IRFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>

					<stage name="CHECKSUM-IN-EquityFuture-FILE" id="CHECKSUM-IN-EquityFuture-FILE-REMOTE">
						<description>Validate checksum for file IN-EquityFuture file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_EquityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_EquityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>

					<stage name="CHECKSUM-IN-FXFuture-FILE" id="CHECKSUM-IN-FXFuture-FILE-REMOTE">
						<description>Validate checksum for file IN-FXFuture file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_FXFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_FXFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					
					<stage name="CHECKSUM-IN-BondFuture-FILE" id="CHECKSUM-IN-BondFuture-FILE-REMOTE">
						<description>Validate checksum for file IN-BondFuture file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_BondFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_BondFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					
					<stage name="CHECKSUM-CM-TBill-FILE" id="CHECKSUM-CM-TBill-FILE-REMOTE">
						<description>Validate checksum for CSM TBill file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_TBill_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_TBill_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-CM-FRN-FILE" id="CHECKSUM-CM-FRN-FILE-REMOTE">
						<description>Validate checksum for CSM FRN file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_FRN_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_FRN_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-ConvertibleBond-FILE" id="CHECKSUM-IN-ConvertibleBond-FILE-REMOTE">
						<description>Validate checksum for CSM Convertible Bond file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_ConvertibleBond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_ConvertibleBond_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-BondFutureOption-FILE" id="CHECKSUM-IN-BondFutureOption-FILE-REMOTE">
						<description>Validate checksum for file IN-BondFutureOption file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_BondFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_BondFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-CommodityFuture-FILE" id="CHECKSUM-IN-CommodityFuture-FILE-REMOTE">
						<description>Validate checksum for file IN-CommodityFuture file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_CommodityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_CommodityFuture_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-EquityOption-FILE" id="CHECKSUM-IN-EquityOption-FILE-REMOTE">
						<description>Validate checksum for file IN-EquityOption file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_EquityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_EquityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-FXOption-FILE" id="CHECKSUM-IN-FXOption-FILE-REMOTE">
						<description>Validate checksum for file IN-FXOption file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_FXOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_FXOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-CommodityOption-FILE" id="CHECKSUM-IN-CommodityOption-FILE-REMOTE">
						<description>Validate checksum for file IN-CommodityOption file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_CommodityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_CommodityOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-IRFutureOption-FILE" id="CHECKSUM-IN-IRFutureOption-FILE-REMOTE">
						<description>Validate checksum for file IN-IRFutureOption file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_IRFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_IRFutureOption_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-Warrant-FILE" id="CHECKSUM-IN-Warrant-FILE-REMOTE">
						<description>Validate checksum for file IN-Warrant file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Warrant_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Warrant_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-TradableLoan-FILE" id="CHECKSUM-IN-TradableLoan-FILE-REMOTE" enabled="false">
						<description>Validate checksum for file IN-TradableLoan file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_TradableLoan_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_TradableLoan_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-CM-LegalEntity-FILE" id="CHECKSUM-CM-LegalEntity-FILE-REMOTE">
						<description>Validate checksum for CSM LegalEntity file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_PA_(LegalEntity|Entity)_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_PA_(LegalEntity|Entity)_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					<stage name="CHECKSUM-IN-Status-FILE" id="CHECKSUM-IN-Status-FILE-REMOTE">
						<description>Validate checksum for CSM Status file</description>
						<execDefinition>
							<checksumValidation>
								<sourceResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Status_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv</searchPattern>
								</sourceResource>
								<markerResource>
									<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
									<searchPattern>CSM_IN_Status_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.csv.mrk</searchPattern>
								</markerResource>
								<checksumAlgorithm>SHA256</checksumAlgorithm>
							</checksumValidation>
						</execDefinition>
					</stage>
					</parallel>
				<externalWorkflowReference name="PREPARE-REMOTE-LOAD" id="PREPARE-REMOTE-LOAD">
					<skipCondition>${CM-CSM-ENRICHMENT-REQUEST.RECORD-COUNT} == 0  </skipCondition>
					<externalWorkflowCode>PREPARE-CM-LOAD-WF</externalWorkflowCode>
					<inputProperties>
						<property name="SOURCE-SYSTEM">CSM</property>
						<property name="SOURCE-SYSTEM-LC">csm</property>
						<property name="CTR-SOURCE-SYSTEM-CODE">CSM</property>
						<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
						<property name="RUN-ID">${RUN-ID}</property>
						<property name="FTP-SOURCE-DIR">${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</property>
						<property name="PROCESSING-DIR">${CTR_DATA_INBOUND_PATH}</property>
						<property name="HOLDING-SOURCE-DIR">${HOLDING-DIR}</property>
						<property name="REPLICATE-IF-MONTH-END">${REPLICATE-SRC-IF-MONTH-END}</property>
						<property name="IS-MONTH-END">${IS-MONTH-END}</property>
						<property name="EOD-EOM-INDICATOR">${WF-EOD-EOM-INDICATOR}</property>
					</inputProperties>
				</externalWorkflowReference>
				<parallel id="LOAD" name="LOAD-SOURCE-FILES">
					<skipCondition> '${CM-CSM-ENRICHMENT-REQUEST.RECORD-COUNT}' == '0' </skipCondition>
					<externalWorkflowReference name="LOAD-Bond" id="LOAD-Bond">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-Bond-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-Equity" id="LOAD-Equity">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-Equity-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					
					<externalWorkflowReference name="LOAD-IRFuture" id="LOAD-IRFuture">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-IRFuture-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>

					<externalWorkflowReference name="LOAD-EquityFuture" id="LOAD-EquityFuture">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-EquityFuture-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>

					<externalWorkflowReference name="LOAD-FXFuture" id="LOAD-FXFuture">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-FXFuture-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					
					<externalWorkflowReference name="LOAD-BondFuture" id="LOAD-BondFuture">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-BondFuture-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					
					<externalWorkflowReference name="LOAD-TBill" id="LOAD-TBill">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-TBill-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-FRN" id="LOAD-FRN">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-FRN-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-ConvertibleBond" id="LOAD-ConvertibleBond">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-CNV-BND-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-BondFutureOption" id="LOAD-BondFutureOption">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-BondFutureOption-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-CommodityFuture" id="LOAD-CommodityFuture">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-CommodityFuture-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-EquityOption" id="LOAD-EquityOption">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-EquityOption-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-FXOption" id="LOAD-FXOption">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-FXOption-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-CommodityOption" id="LOAD-CommodityOption">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-CommodityOption-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-IRFutureOption" id="LOAD-IRFutureOption">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-IRFutureOption-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-Warrant" id="LOAD-Warrant">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-Warrant-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-TradableLoan" id="LOAD-TradableLoan" enabled="false">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-TradableLoan-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-LegalEntity" id="LOAD-LegalEntity">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#PA-LegalEntity-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>
					<externalWorkflowReference name="LOAD-Status" id="LOAD-Status">
						<externalWorkflowCode>LOAD-FILE-WF</externalWorkflowCode>
						<inputProperties>
							<property name="RUN-ID">${RUN-ID}</property>
							<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
							<property name="SOURCE-FILE">${#IN-Status-FILE}</property>
							<property name="PROCESSING-SOURCE-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-PROCESSING-SOURCE-DIR}</property>
							<property name="CONTROL-PATH">${CTR_CONFIG_ROOT_PATH}/${SQLLDR-CONTROL-DIRECTORY}</property>
							<property name="DISCARD-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-DISCARD-DIR}</property>
							<property name="REJECT-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-REJECT-DIRECTORY}</property>
							<property name="LOG-PATH">${CTR_DATA_ROOT_PATH}/${SQLLDR-LOG-DIRECTORY}</property>
							<property name="DATA-CATEGORY">${DATA-CATEGORY-TYPE}</property>
							<property name="DELIMITER">,</property>
						</inputProperties>
					</externalWorkflowReference>

				</parallel>
				<externalWorkflowReference name="CM-ETL-ENRICHMENT-WF" id="CM-ETL-ENRICHMENT-WF">
					<skipCondition>${CM-CSM-ENRICHMENT-REQUEST.RECORD-COUNT} == 0</skipCondition>
					<externalWorkflowCode>CM-ETL-ENRICHMENT-WF</externalWorkflowCode>
					<inputProperties>
						<property name="SOURCE-SYSTEM">CSM</property>
						<property name="SOURCE-SYSTEM-LC">csm</property>
						<property name="BUSINESS-DATE">${BUSINESS-DATE}</property>
						<property name="RUN-ID">${RUN-ID}</property>
						<property name="EOD-EOM-IND">${WF-EOD-EOM-INDICATOR}</property>
					</inputProperties>
				</externalWorkflowReference>
			</sequential>
		</parallel>
		
		<!-- FINALIZE PHASE -->

		<stage name="CLEAN-UP-FTP-DIR-REMOTE" id="CLEAN-UP-FTP-DIR-REMOTE">
			<description>Clean up files in FTP directory</description>
			<skipCondition>'${CM-CSM-ENRICHMENT-REQUEST.RECORD-COUNT}' == '0'</skipCondition>
			<execDefinition>
				<deleteResource failOnError="false">
					<resource>
						<uri>${CTR_FTP_ROOT_PATH}/${FTP-SOURCE-DIR}</uri>
						<searchPattern>CSM_.+_${SRC-FILE-SUFFIX-PATTERN-REMOTE}.*(csv|mrk)</searchPattern>
					</resource>
					<deleteCountProperty>matchedDelRemCount</deleteCountProperty>
				</deleteResource>
			</execDefinition>
		</stage>
	</sequential>
	
</workflow>